# Phase2 Outline (Product Planning · 2025-09-19)

> 更新说明：依据《网页需求.md》《怎么实现我的网页需求.md》以及 Phase2 spec/plan，明确产品目标、用户故事、范围与指标，作为跨组实施依据。

## 1. 背景与目标
- Phase1 已交付模板广场、授权指引与基础计费链路，下一阶段需与平台积分/授权服务打通，确保算力收入闭环与合规可追溯。
- 完成实时任务体验与风险处置闭环：补扣、加速、审核/举报流程需要统一事件推送与状态回滚能力。
- 建立可运营的数据与审计基线，为后续 MQ/训练等扩展能力提供接口与指标参考。

## 2. 用户故事 / JTBD
| Persona | JTBD | 业务价值 | 备注 |
| --- | --- | --- | --- |
| 创作者（Creator） | 我需要确认授权对象的算力额度与任务状态，快速定位异常任务或撤销授权 | 提升授权留存率，减少算力纠纷 | 依赖 `/licenses/check`、任务推送、审核面板 |
| 账号运营者（Buyer/User） | 我想在提交任务前看到准确的积分预估，并在任务执行中获知进度/加速选项 | 降低试错成本，提升积分复购率 | 依赖 `/credits/estimate`、实时推送、补扣弹窗 |
| 运营合规（Moderator/Ops） | 我需要在平台后台看到举报/审核队列、风险等级与日志，以便快速处置 | 确保违规闭环、保护资产 | 依赖 audit log、policy_tag 埋点、权限矩阵 |
| 平台管理员（Admin） | 我需要掌握积分收入、任务成功率、接口错误率，判断是否需要扩容或调价 | 保障平台现金流与服务质量 | 依赖 metrics 埋点、ledger/settle 统计 |

## 3. 范围
### 必须交付（2025-09-26 前）
1. **平台接口适配层**：落地 `/credits/estimate`·`/credits/charge`·`/credits/refund` 与 `/licenses/check`，覆盖鉴权、错误码、重试与 TDD。
2. **任务实时推送**：提供 WebSocket/SSE 双通道协议、断线重连、事件签名校验，支撑补扣、加速与审核通知。
3. **补扣 & 风控交互**：补扣弹窗状态、加速横幅、审核/举报面板串联平台事件，并支持异常回滚文案。
4. **审计留痕**：tasks/audit log/policy_tag 字段落地，前后端埋点对齐 shared/metrics 方案。
5. **文档交付**：API 设计说明、权限矩阵、实时推送契约、审计方案、联调复盘按 spec/plan 要求更新。

### 可选/规划项
- 任务负载指标可视化：若时间允许，增加管理后台的实时队列与积分收入概览（数据来源复用 ledger & metrics）。
- Creator 通知模板优化：结合 content-ops 通知矩阵，提供授权异常提醒（短信/站内信）。

## 4. 成功指标
| 指标 | 目标 | 测量方式 |
| --- | --- | --- |
| 估价准确度 | 预测 vs 实际误差 ≤ ±10%（普通队列）；≤ ±5%（加速队列） | 对比 `/credits/estimate` 与结算日志 |
| 接口稳定性 | `/credits/*` `/licenses/check` 联调阶段错误率 < 2% | 阶段性 API 统计与 error log |
| 实时延迟 | 任务状态推送 ≤ 3s，断线 5s 内恢复 | WebSocket/SSE 指标埋点 |
| 审计完整率 | 100% 任务写入 audit log & policy_tag | 日志抽查 + 自动校验脚本 |
| 积分复购率 | 加速/补扣交互上线后一周内复购率≥ Phase1 基线 +8% | wallets/transactions 统计 |

## 5. 里程碑
| 日期 | 交付内容 | 验收要点 |
| ---- | ---- | ---- |
| 9/19 | Phase2 产品大纲定稿（本文件）+ Spec 评审解锁 | 各组确认目标 & 指标；T2-1 解除阻塞 |
| 9/20 | `/credits` `/licenses` 实现计划 & 单测脚手架 | 代码结构与测试约定审阅通过 |
| 9/22 | 实时推送协议草案 + UI 交互走查 | 推送事件字段、重试策略确认 |
| 9/23 | 审计/埋点方案敲定（含 policy_tag 枚举） | ops/compliance 签字，FE/BE 接收 |
| 9/24 | 测试环境联调（积分/授权/推送） | 全链路跑通、回归测试记录 |
| 9/25 | 联调复盘报告 + 风险清单 | 产出问题列表、保留/回滚策略 |
| 9/26 | Phase2 后端规划初稿 | 评估训练/扩容演进路径 |

## 6. 风险与应对
- **接口依赖未就绪**：平台侧 `/credits/*` 错误码或字段变更 → 建议每日 12:00 前同步差异，Mock 契约与 openapi 同步更新。
- **实时推送复杂度**：断线 & 多窗口场景需权衡 WebSocket 与 SSE → 通过统一 token + fallback 机制，并于 9/22 前完成压测脚本。
- **埋点指标口径不一**：metrics 与 audit log 字段可能冲突 → 由 shared/metrics 与 operations-compliance 共用数据字典，自检 checklist 进度。
- **素材/文案依赖**：补扣/审核文案需 content-ops 交付 → 若 9/20 前未交，UI 使用占位文案并标明风控风险。

## 7. 下一步
1. 产品规划向各组发起 Phase2 目标确认，收集补充反馈，若有范围变更需在 9/20 前更新 Spec/Plan。
2. 与 platform-integration 对齐 `/credits` `/licenses` 单测覆盖范围（测试场景：余额不足、授权过期、冻结失败等）。
3. 与 experience-design & frontend-build 共审补扣/加速交互稿，确保推送事件字段满足 UI 需求。
4. operations-compliance 完成 policy_tag 枚举与审核 SLA 绑定，输入 shared/metrics。
